<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom functions for your OpenShift Serverless Logic service :: Red Hat OpenShift Serverless previews</title>
    <link rel="canonical" href="https://openshift-knative.github.io/docs/docs/latest/serverless-logic/core/custom-functions-support.html">
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../_/css/extra.css">
<link rel="stylesheet" href="../../../../_/css/custom.css">
<link rel="stylesheet" href="../../../../_/css/tabs.css">
<link rel="stylesheet" href="../../../../_/font-awesome-4.7.0/css/font-awesome.min.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <button class="navbar-burger" data-target="topbar-nav">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <img src="../../../../_/img/serverless-icon.png" class="navbar-logo" alt="OpenShift Serverless icon">
        <a href="">OpenShift Serverless - Technology and Developer Preview Releases</a>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- search broken
        <div class="navbar-item hide-for-print">
          <script async src="https://cse.google.com/cse.js?cx=002898025167115630151:gnr5edrg2eo"></script>
          <div class="gcse-searchbox" enableAutoComplete="true"></div>
        </div>
      -->
        <a class="navbar-item" href="https://openshift-knative.github.io/docs">Home</a>
        <a class="navbar-item" href="https://developers.redhat.com/topics/serverless-architecture">Blog</a>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Upstream Projects</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://kogito.kie.org/">Kogito</a>
                  <a class="navbar-item" href="https://knative.dev/docs/functions/">Knative Functions</a>
                  <a class="navbar-item" href="https://knative.dev/docs/eventing/">Knative Eventing</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
<!-- need alt search type-->
<!--<div class="gcse-searchresults"></div>-->
</header>
<div class="main-wrapper">
  <div class="navigation-container" data-component="docs" data-version="main">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Serverless</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Using OpenShift Serverless with OpenShift Service Mesh</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/service-mesh/common-service-mesh-setup.html">Setup Serverless with OpenShift Service Mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/service-mesh/common-service-mesh-network-isolation.html">Use Service Mesh to isolate network-traffic</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/service-mesh/eventing-service-mesh-containersource.html">Eventing: Using ContainerSource with OpenShift Service Mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/service-mesh/eventing-service-mesh-sinkbinding.html">Eventing: Using SinkBinding with OpenShift Service Mesh</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Eventing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/eventing/transport-encryption-setup.html">Setup transport encryption in Eventing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/eventing/kafka-scaling-setup.html">Setup Autoscaling For Eventing Kafka Components</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/eventing/backstage-setup.html">Setup Backstage for Eventing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/eventing/backstage-usage.html">Knative Event Mesh Backstage Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Serving</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/serving/serving-with-ingress-sharding.html">Use Serving with OpenShift ingress sharding</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/serving/scaleability-and-performance-of-serving.html">Scalability and performance of OpenShift Serverless Serving</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../serverless/serving/serving-transport-encryption.html">Serving Transport Encryption</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Serverless Logic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../about.html">About OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release-notes.html">Release notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">User Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/learning-environment.html">Learning environment</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/preparing-environment.html">Environment setup</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/production-environment.html">Production environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/create-your-first-workflow-service-with-kn-cli-and-vscode.html">Creating and running workflow projects using KN CLI and Visual Studio Code</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/getting-familiar-with-our-tooling.html">Getting familiar with OpenShift Serverless Logic tooling</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Core</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="cncf-serverless-workflow-specification-support.html">Serverless Workflow Specification</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="handling-events-on-workflows.html">Events</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="working-with-callbacks.html">Callbacks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="understanding-jq-expressions.html">jq Expressions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="understanding-workflow-error-handling.html">Error handling</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="configuration-properties.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="defining-an-input-schema-for-workflows.html">Input Schema</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="custom-functions-support.html">Custom functions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="timeouts-support.html">Timeouts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="working-with-parallelism.html">Parallelism</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Tooling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-overview.html">Editor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-vscode-extension.html">VS Code extension</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-chrome-extension.html">Chrome extension for GitHub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-overview.html">Serverless Logic Web Tools</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-github-integration.html">Integration with GitHub</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-openshift-integration.html">Integration with OpenShift</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-redhat-application-services-integration.html">Red Hat OpenShift Application and Data Services integration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-deploy-projects.html">Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../service-orchestration/orchestration-of-openapi-based-services.html">Orchestrating the OpenAPI services</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../service-orchestration/configuring-openapi-services-endpoints.html">Configuring the OpenAPI services endpoints</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../service-orchestration/working-with-openapi-callbacks.html">OpenAPI callbacks in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../service-orchestration/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Event Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/orchestration-of-asyncapi-based-services.html">Orchestrating AsyncAPI Services</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/event-correlation-with-workflows.html">Event Correlation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../security/authention-support-for-openapi-services.html">Authentication for OpenAPI services</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../security/orchestrating-third-party-services-with-oauth2.html">Orchestration of third-party services using OAuth 2.0 authentication</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Executing, Testing and Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <span class="nav-text">Executing and Testing Workflows</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-overview.html">Developer UI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-instances-page.html">Workflow Instances</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-definition-page.html">Workflow Definitions</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-monitoring-page.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-custom-dashboard-page.html">Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../testing-and-troubleshooting/kn-plugin-workflow-overview.html">Command Line</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../persistence/core-concepts.html">Core concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../cloud/index.html">Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../cloud/custom-ingress-authz.html">Securing Workflows</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <span class="nav-text">Operator</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/install-serverless-operator.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Upgrade</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../cloud/operator/upgrade-serverless-operator/upgrade_1_34_0_to_1_35_0.html">OSL 1.34.0 to 1.35.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/global-configuration.html">Admin Configuration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/developing-workflows.html">Development Mode</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/referencing-resource-files.html">Referencing Workflow Resources</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/configuring-workflows.html">Workflow Configuration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/build-and-deploy-workflows.html">Building and Deploying Workflow Images</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/supporting-services.html">Deploy Supporting Services</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/workflow-status-conditions.html">Custom Resource Status</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/building-custom-images.html">Building Custom Images</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/customize-podspec.html">Custom Workflow PodSpec</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/service-discovery.html">Service Discovery</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/using-persistence.html">Using persistence</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/configuring-knative-eventing-resources.html">Knative Eventing</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="#cloud/operator/add-custom-ca-to-a-workflow-pod.adoc">Add Custom CA to Workflow Pod</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../cloud/operator/known-issues.html">Roadmap and Known Issues</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/core-concepts.html">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Supporting Services</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <span class="nav-text">Jobs Service</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../job-services/core-concepts.html">Core Concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <span class="nav-text">Data Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../data-index/data-index-core-concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../data-index/data-index-service.html">Data Index Standalone Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Use Cases</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/index.html">Development of OpenShift Serverless Logic applications using Quarkus and Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/create-your-first-workflow-service.html">Creating a Quarkus Workflow service</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/create-your-first-workflow-project.html">Creating a Quarkus Workflow project</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/build-workflow-image-with-quarkus-cli.html">Building workflow images using Quarkus CLI</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/working-with-serverless-workflow-quarkus-examples.html">Working with OpenShift Serverless Logic example applications</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/test-serverless-workflow-quarkus-examples.html">Testing images of OpenShift Serverless Logic example applications using Quarkus CLI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Deployment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-minikube.html">Deploying on Minikube</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-kubernetes.html">Deploying on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-openshift.html">Deploying on OpenShift</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/persistence-core-concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/persistence-with-postgresql.html">Running a Quarkus Workflow Application using PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/postgresql-advanced-concepts.html">Postgresql Advanced Concepts</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/postgresql-flyway-migration.html">PostgreSQL Database Migration</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/integration-tests-with-postgresql.html">OpenShift Serverless Logic integration test using PostgreSQL</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Data Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-as-quarkus-dev-service.html">Data Index as a Quarkus Development service</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-usecase-singleton.html">Deploying Data Index and OpenShift Serverless Logic application on Minikube</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-usecase-multi.html">Deploying Data Index and multiple OpenShift Serverless Logic applications on Minikube</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-quarkus-extension.html">Data Index Quarkus extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-orchestration/configuring-openapi-services-endpoints-with-quarkus.html">Configuring the OpenAPI services endpoints in different environments</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-orchestration/orchestration-of-grpc-services.html">Orchestrating gRPC based Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Service Discovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-discovery/kubernetes-service-discovery.html">Kubernetes service discovery in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Event Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/consume-produce-events-with-knative-eventing.html">Consuming and producing events on Knative Eventing in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/consume-producing-events-with-kafka.html">Consuming and producing events using Apache Kafka in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/orchestration-based-saga-pattern.html">Saga orchestration example in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/newsletter-subscription-example.html">Newsletter subscription example in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Timeouts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/timeouts/timeout-showcase-example.html">Timeouts Showcase in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Callbacks</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/callbacks/callback-state-example.html">Example of OpenShift Serverless Logic application using callback state with Quarkus</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Integrations of external services</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/camel-routes-integration.html">Integrating with Camel routes</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/custom-functions-knative.html">Invoking Knative services from OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/expose-metrics-to-prometheus.html">Exposing Workflow base metrics to Prometheus</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/serverless-dashboard-with-runtime-data.html">Displaying Workflow Data in Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="5">
    <button class="nav-toggle"></button>
    <span class="nav-text">Testing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/basic-integration-tests-with-restassured.html">Testing your Quarkus Workflow Application using REST Assured</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/mocking-http-cloudevents-with-wiremock.html">Mocking HTTP CloudEvents sink using WireMock</a>
  </li>
  <li class="nav-item" data-depth="6">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/mocking-openapi-services-with-wiremock.html">Mocking OpenAPI services using WireMock</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Buildpacks for Serverless Functions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-functions-about.html">About buildpacks for OpenShift Serverless Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-functions-buildpacks.html">Building and deploying functions on the cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Documentation</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Documentation</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../../index.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <div class="main-view-and-toolbar">
    <div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../index.html">Documentation</a></li>
    <li class="crumb">Serverless Logic</li>
    <li class="crumb">User Guides</li>
    <li class="crumb">Core</li>
    <li class="crumb"><a href="custom-functions-support.html">Custom functions</a></li>
  </ul>
</nav>
</div>
    <div class="main-view-and-toc">
        <main class="main">
          <article class="doc">
<h1>Custom functions for your OpenShift Serverless Logic service</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Cloud Native Computing Foundation (CNCF) specification <a href="https://github.com/serverlessworkflow/specification/blob/0.8.x/specification.md#defining-custom-function-types">supports the <code>custom</code> function type</a>, which enables the implementations to extend the function definition capability.</p>
</div>
<div class="paragraph">
<p>OpenShift Serverless Logic supports several custom types, which are listed below.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Custom functions might not be portable across other implementations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#con-func-sysout">Sysout custom function</a></li>
<li><a href="#con-func-java">Java custom function</a>
<ul class="sectlevel2">
<li><a href="#_function_definition">Function Definition</a></li>
<li><a href="#_function_arguments">Function Arguments</a></li>
<li><a href="#_function_return_values">Function return values</a></li>
<li><a href="#_function_accessing_contextual_data">Function accessing contextual data</a></li>
</ul>
</li>
<li><a href="#con-func-camel">Camel custom function</a>
<ul class="sectlevel2">
<li><a href="#_function_definition_2">Function definition</a></li>
<li><a href="#_function_arguments_2">Function arguments</a></li>
<li><a href="#_function_return_values_2">Function return values</a></li>
</ul>
</li>
<li><a href="#con-func-python">Python custom function</a></li>
<li><a href="#con-func-knative">Knative custom function</a>
<ul class="sectlevel2">
<li><a href="#_function_definition_3">Function definition</a></li>
<li><a href="#_function_arguments_3">Function arguments</a></li>
<li><a href="#_configurations">Configurations</a></li>
</ul>
</li>
<li><a href="#con-func-rest">REST custom function</a></li>
<li><a href="#_additional_custom_function_types">Additional custom function types</a>
<ul class="sectlevel2">
<li><a href="#_custom_function_type_example">Custom function type example</a></li>
</ul>
</li>
<li><a href="#_additional_resources">Additional resources</a></li>
<li><a href="#_found_an_issue"><em><strong>Found an issue?</strong></em></a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="con-func-sysout"><a class="anchor" href="#con-func-sysout"></a>Sysout custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the <code>sysout</code> function for logging as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example of <code>sysout</code> function definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functions": [
    {
      "name": "logInfo",
      "type": "custom",
      "operation": "sysout:INFO"
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The string after the <code>:</code> is optional and is used to indicate the log level.  The possible values are TRACE, DEBUG, INFO, WARN, and ERROR. If not present, INFO is considered by default.</p>
</div>
<div class="paragraph">
<p>In the <code>state</code> definition, you can call the same <code>sysout</code> function as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>sysout</code> function reference within a <code>state</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "states": [
    {
      "name": "myState",
      "type": "operation",
      "actions": [
        {
          "name": "printAction",
          "functionRef": {
            "refName": "logInfo",
            "arguments": {
              "message": "\"Workflow model is \\(.)\""
            }
          }
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>message</code> argument can be a jq expression or a jq string using interpolation, as in the example above</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-func-java"><a class="anchor" href="#con-func-java"></a>Java custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Serverless Logic supports the <code>java</code> functions within an Apache Maven project, in which you define your workflow service.</p>
</div>
<div class="sect2">
<h3 id="_function_definition"><a class="anchor" href="#_function_definition"></a>Function Definition</h3>
<div class="paragraph">
<p>The following example shows the declaration of a <code>java</code> function:</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>java</code> function declaration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functions": [
    {
      "name": "myFunction", <i class="conum" data-value="1"></i><b>(1)</b>
      "type": "custom", <i class="conum" data-value="2"></i><b>(2)</b>
      "operation": "service:java:com.acme.MyInterfaceOrClass::myMethod" <i class="conum" data-value="3"></i><b>(3)</b>
    }
  ]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>myFunction</code> is the function name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>custom</code> is the function type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>service:java:com.acme.MyInterfaceOrClass::myMethod</code> is the custom operation definition. In the custom operation definition, <code>service</code> is the reserved operation keyword followed by the <code>java</code> keyword. <code>com.acme.MyInterfaceOrClass</code> is the FQCN (Fully Qualified Class Name) of the interface or implementation class followed by the method name (<code>myMethod</code>).</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_function_arguments"><a class="anchor" href="#_function_arguments"></a>Function Arguments</h3>
<div class="paragraph">
<p>Your method interface signature must copy the arguments passed by the workflow.</p>
</div>
<div class="paragraph">
<p>For example, if you invoke a function using one argument as follows, then your method signature assumes that the <code>number</code> model variable is an integer:</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>java</code> function reference with one argument</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "functionRef": {
   "refName": "myFunction",
   "arguments": {
     "number": "${.number}"
   }
 }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example of a <code>java</code> function implementation</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyInterfaceOrClass {

  public void myMethod(int number) {
        if (number % 2 != 0) {
            throw new IllegalArgumentException("Odd situation");
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a particular case, if you provide no argument in the workflow definition, the signature of the Java method might include a <a href="https://github.com/FasterXML/jackson">Jackson&#8217;s</a> <code>JsonNode</code> parameter. This means that the Java method expects the entire workflow model as input.</p>
</div>
<div class="paragraph">
<p>When using the following example function reference with no arguments, and if the method signature contains a <code>JsonNode</code> parameter, the entire workflow model is passed when the method call is performed.</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>java</code> function reference with no arguments</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functionRef": {
    "refName": "myFunction"
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example of a <code>java</code> function implementation</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyInterfaceOrClass {

    public JsonNode myMethod(JsonNode workflowData) {
        // do whatever I want with the Workflow model
        ......
        // return the modified content:
        return workflowData;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_function_return_values"><a class="anchor" href="#_function_return_values"></a>Function return values</h3>
<div class="paragraph">
<p>If your method returns a <code>JsonNode</code>, the content of that node is merged into the workflow model (you can use an action data filter to control what is merged).</p>
</div>
<div class="paragraph">
<p>The same occurs if your method returns any Java <code>Object</code> descendant that is not a primitive wrapper, the Java object is recursively converted to a JSON object and the result is merged into the workflow model (you can use an action data filter to control what is merged).</p>
</div>
<div class="paragraph">
<p>If your method returns a primitive type or their corresponding wrapper object (int, boolean, long, and so on), then the primitive value is added to the workflow model with the name <code>response</code> (you can change that name using an action data filter).</p>
</div>
<div class="paragraph">
<p>If your method returns Java collections, it is converted to a JSON array and added to the workflow model with the name <code>response</code> (you can change that name using an action data filter).</p>
</div>
</div>
<div class="sect2">
<h3 id="_function_accessing_contextual_data"><a class="anchor" href="#_function_accessing_contextual_data"></a>Function accessing contextual data</h3>
<div class="paragraph">
<p>If you need access to process contextual information (for example, Kogito process instance ID) inside your Java service, you can add a <code>KogitoProcessContext</code> parameter as the last one in the method signature.</p>
</div>
<div class="paragraph">
<p>Therefore, if you need to do so, you can update the signature of methods from previous sections.</p>
</div>
<div class="listingblock">
<div class="title">Example of a function accessing Kogito context</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyInterfaceOrClass {
public JsonNode myMethod(JsonNode workflowData, KogitoProcessContext context ) {
        // do whatever I want with the JsonNode and the Kogito process context
        ......
        // return the modified content:
        return workflowData;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example of a function accessing Kogito context</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyInterfaceOrClass {


    public void myMethod(int number, KogitoProcessContext context) {
        if (number % 2 != 0) {
            throw new IllegalArgumentException("Odd situation");
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Avoid using <code>java</code> functions to call the external services, instead, you can use the <a href="../service-orchestration/orchestration-of-openapi-based-services.html" class="xref page">services orchestration features</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-func-camel"><a class="anchor" href="#con-func-camel"></a>Camel custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kogito supports the <a href="https://camel.apache.org/">Camel Routes</a> functions within an Apache Maven project, in which you define your workflow service.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section briefly exemplifies how to define and use Camel Routes within your workflow application. For more information, see the <a href="../use-cases/advanced-developer-use-cases/integrations/camel-routes-integration.html" class="xref page">Integrating with Camel Routes</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_function_definition_2"><a class="anchor" href="#_function_definition_2"></a>Function definition</h3>
<div class="paragraph">
<p>The following example shows the declaration of a Camel function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functions": [
    {
      "name": "myCamelEndpoint", <i class="conum" data-value="1"></i><b>(1)</b>
      "type": "custom",  <i class="conum" data-value="2"></i><b>(2)</b>
      "operation": "camel:direct:myendpoint" <i class="conum" data-value="3"></i><b>(3)</b>
    }
  ]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>myCamelEndpoint</code> is the function name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>custom</code> is the function type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>camel:direct:myendpoint</code> is the custom operation definition. In this definition, <code>camel</code> is the reserved keyword followed by the <code>direct</code> endpoint. <a href="https://camel.apache.org/camel-quarkus/3.2.x/reference/extensions/direct.html">Camel Direct</a> is the only supported consumer by OpenShift Serverless Logic. Finally, <code>myendpoint</code> is the endpoint URI name found in the route within your project&#8217;s context.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_function_arguments_2"><a class="anchor" href="#_function_arguments_2"></a>Function arguments</h3>
<div class="paragraph">
<p>The Camel function arguments must follow a specific structure when passing data from the workflow state to the route. The <code>body</code> and <code>headers</code> are the only attributes supported in the function arguments. Both are optional if you need to call the Camel routes without arguments. The only constraint is that you can not call a Camel route with only <code>headers</code>.</p>
</div>
<div class="paragraph">
<p>The following examples display valid argument structures for Camel function arguments:</p>
</div>
<div class="listingblock">
<div class="title">Example calling a Camel route using <code>body</code> and <code>headers</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functionRef": {
    "refName": "myCamelEndpoint",
    "arguments": {
      "body": "${ .my.body.data }", <i class="conum" data-value="1"></i><b>(1)</b>
      "headers": { <i class="conum" data-value="2"></i><b>(2)</b>
        "key1": "${ .my.value }",
        "key2": "${ .my.other.value }"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>jq</code> expression filtering the state data for the <code>body</code> argument.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>JSON key/value pair for the <code>headers</code> argument. A <code>jq</code> expression returning the same JSON object is also valid.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example calling a Camel route using <code>body</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functionRef": {
    "refName": "myCamelEndpoint",
    "arguments": {
      "body": "${ .my.body.data }"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example calling a Camel route without arguments</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functionRef": {
    "refName": "myCamelEndpoint"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example calling a Camel route with only one argument</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functionRef": {
    "refName": "myCamelEndpoint",
    "arguments": "${ .my.body.data }"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this last example, the <code>jq</code> expression result is used as the <code>body</code> argument in a way to simplify the definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="_function_return_values_2"><a class="anchor" href="#_function_return_values_2"></a>Function return values</h3>
<div class="paragraph">
<p>The Camel route is responsible to produce the return value in a way that the workflow can understand. The following are considered valid objects:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A string that contains a valid JSON object</p>
</li>
<li>
<p>A valid Java bean that can be serialized to JSON</p>
</li>
<li>
<p>A Jackson&#8217;s <code>JsonNode</code> object</p>
</li>
<li>
<p>Any primitive type (Integer, Float, Decimal, String, etc)</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-func-python"><a class="anchor" href="#con-func-python"></a>Python custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Serverless Logic implements a custom function to execute embedded Python scripts and functions. See <a href="../use-cases/advanced-developer-use-cases/integrations/custom-functions-python.html" class="xref page">Invoking Python from OpenShift Serverless Logic</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-func-knative"><a class="anchor" href="#con-func-knative"></a>Knative custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Serverless Logic provides an implementation of a custom function through the <code>knative-serving</code> add-on to invoke Knative services. It allows you to have a static URI, defining a Knative service, which is used to perform HTTP requests. The Knative service defined in the URI is queried in the current Knative cluster and translated to a valid URL.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section briefly exemplifies how to define and use Knative custom functions within your workflow application. For more information, see <a href="../use-cases/advanced-developer-use-cases/integrations/custom-functions-knative.html" class="xref page">Invoking Knative services from Serverless Workflow</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_function_definition_3"><a class="anchor" href="#_function_definition_3"></a>Function definition</h3>
<div class="paragraph">
<p>Given the following deployed Knative service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ kn service list
NAME                              URL                                                                      LATEST                                  AGE     CONDITIONS   READY   REASON
custom-function-knative-service   http://custom-function-knative-service.default.10.109.169.193.sslip.io   custom-function-knative-service-00001   3h16m   3 OK / 3     True</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can declare a OpenShift Serverless Logic custom function using the Knative service name, like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "functions": [
    {
      "name": "greet", <i class="conum" data-value="1"></i><b>(1)</b>
      "type": "custom", <i class="conum" data-value="2"></i><b>(2)</b>
      "operation": "knative:services.v1.serving.knative.dev/custom-function-knative-service?path=/plainJsonFunction", <i class="conum" data-value="3"></i><b>(3)</b>
    }
  ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>greet</code> is the function name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>custom</code> is the function type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In <code>operation</code> you set the coordinates of the Knative service. See <a href="../use-cases/advanced-developer-use-cases/service-discovery/kubernetes-service-discovery.html" class="xref page">Kubernetes Service Discovery</a> for supported Scheme and Kubernetes GVK</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above function will send a <code>POST</code> request to the <a href="http://custom-function-knative-service.default.10.109.169.193.sslip.io/plainJsonFunction" class="bare">custom-function-knative-service.default.10.109.169.193.sslip.io/plainJsonFunction</a> URL. If you don&#8217;t specify a path, OpenShift Serverless Logic will use the root path (/).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also send <code>GET</code> requests by setting <code>method=GET</code> in <code>operation</code>. In this case, the arguments are forwarded over a query string.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example of a <code>GET</code> request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "functions": [
    {
      "name": "greet",
      "type": "custom",
      "operation": "knative:services.v1.serving.knative.dev/custom-function-knative-service?path=/plainJsonFunction&amp;method=GET", <i class="conum" data-value="1"></i><b>(1)</b>
    }
  ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>GET</code> request</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="about-namespaces"><a class="anchor" href="#about-namespaces"></a>About namespaces</h4>
<div class="paragraph">
<p>Note that in the above example, you declared only the name of the service you wanted to call, but not a namespace. In this case, OpenShift Serverless Logic will look for a Knative service in the same namespace the workflow service is running.</p>
</div>
<div class="paragraph">
<p>In case you need to call a Knative service in a different namespace, you can declare the function as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "functions": [
    {
      "name": "greet",
      "type": "custom",
      "operation": "knative:services.v1.serving.knative.dev/my_different_namespace/custom-function-knative-service?path=/plainJsonFunction"
    }
  ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, OpenShift Serverless Logic will look for the <code>custom-function-knative-service</code> in the <code>my_different_namespace</code> namespace.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_function_arguments_3"><a class="anchor" href="#_function_arguments_3"></a>Function arguments</h3>
<div class="paragraph">
<p>In case you need to send a payload in the request, you can add it to <code>arguments</code> in <code>functionRef</code>.</p>
</div>
<div class="sect3">
<h4 id="_sending_a_regular_json_object"><a class="anchor" href="#_sending_a_regular_json_object"></a>Sending a regular JSON object</h4>
<div class="paragraph">
<p>You must send the following JSON object as the payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "product_id": ".product_id",
  "customer_name": ".customer_name"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must declare a <code>functionRef</code> like the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "states": [
    {
      "name": "invokeFunction",
      "type": "operation",
      "actions": [
        {
          "functionRef": {
            "refName": "greet",
            "arguments": { <i class="conum" data-value="1"></i><b>(1)</b>
              "product_id": ".product_id",
              "customer_name": ".customer_name"
            }
          }
        }
      ],
      "end": true
    }
  ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The request payload is set in <code>arguments</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sending-cloudevents"><a class="anchor" href="#sending-cloudevents"></a>Sending a CloudEvent</h4>
<div class="paragraph">
<p>By default, OpenShift Serverless Logic sends the payload of a Knative function as a regular JSON object and <code>Content-Type</code> as <code>application/json</code>. However, you can tell OpenShift Serverless Logic to send the payload as a CloudEvent. In that case, OpenShift Serverless Logic will check if the CloudEvent has all mandatory attributes set and use <code>application/cloudevents+json; charset=UTF-8</code> in <code>Content-Type</code>.</p>
</div>
<div class="paragraph">
<p>To tell OpenShift Serverless Logic you want to send the payload as a CloudEvent, you must define your function as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "functions": [
    {
      "name": "greet",
      "type": "custom",
      "operation": "knative:services.v1.serving.knative.dev/custom-function-knative-service?path=/plainJsonFunction&amp;asCloudEvent=true" <i class="conum" data-value="1"></i><b>(1)</b>
    }
  ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Tells OpenShift Serverless Logic to send the payload as a CloudEvent. Default is <code>false</code></td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not set the <code>asCloudEvent</code> attribute to <code>true</code>,  you can not send a CloudEvent. If you do so, OpenShift Serverless Logic will throw an error.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You must send the following CloudEvent as the payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "specversion" : "1.0",
  "type" : "com.github.pull_request.opened",
  "source" : "https://github.com/cloudevents/spec/pull",
  "subject" : "123",
  "time" : "2018-04-05T17:31:00Z",
  "comexampleextension1" : "value",
  "comexampleothervalue" : 5,
  "datacontenttype" : "text/xml",
  "data" : "&lt;much wow=\"xml\"/&gt;"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You must declare a <code>functionRef</code> like the following: (Do not forget to set <code>asCloudEvent</code> as <code>true</code> in function metadata)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "states": [
    {
      "name": "invokeFunction",
      "type": "operation",
      "actions": [
        {
          "functionRef": {
            "refName": "greet",
            "arguments": { <i class="conum" data-value="1"></i><b>(1)</b>
                "specversion" : "1.0",
                "type" : "com.github.pull_request.opened",
                "source" : "https://github.com/cloudevents/spec/pull",
                "subject" : "123",
                "time" : "2018-04-05T17:31:00Z",
                "comexampleextension1" : "value",
                "comexampleothervalue" : 5,
                "datacontenttype" : "text/xml",
                "data" : "&lt;much wow=\"xml\"/&gt;"
            }
          }
        }
      ],
      "end": true
    }
  ]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The CloudEvent is set in <code>arguments</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>OpenShift Serverless Logic generates a CloudEvent ID based on the <code>source</code> and the workflow instance ID. In case you decide to set an ID, OpenShift Serverless Logic will use it and you must ensure it&#8217;s unique. Refer to the following example on how to set a CloudEvent ID:</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Setting a CloudEvent ID</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"arguments": {
    "specversion" : "1.0",
    "id": "a_unique_id_42", <i class="conum" data-value="1"></i><b>(1)</b>
    "type" : "com.github.pull_request.opened",
    "source" : "https://github.com/cloudevents/spec/pull",
    "subject" : "123",
    "time" : "2018-04-05T17:31:00Z",
    "comexampleextension1" : "value",
    "comexampleothervalue" : 5,
    "datacontenttype" : "text/xml",
    "data" : "&lt;much wow=\"xml\"/&gt;"
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The CloudEvent ID.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configurations"><a class="anchor" href="#_configurations"></a>Configurations</h3>
<div class="sect3">
<h4 id="_request_timeout"><a class="anchor" href="#_request_timeout"></a>Request timeout</h4>
<div class="paragraph">
<p>By default, the Knative service must respond within 10 seconds. You can use the <code>kogito.sw.functions.&lt;function_name&gt;.timeout</code> property to configure this value.</p>
</div>
<div class="paragraph">
<p>For instance, if you want to reduce the request timeout to 5 seconds, you must add the following to your <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">kogito.sw.functions.greet.timeout=5000 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Time in milliseconds</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-func-rest"><a class="anchor" href="#con-func-rest"></a>REST custom function</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Serverless Workflow Specification defines the <a href="../service-orchestration/orchestration-of-openapi-based-services.html" class="xref page">OpenAPI function type</a>, which is the preferred way to interact with existing REST servers.
However, sometimes a workflow should interact with several REST APIs that are not described using an OpenAPI specification file. Since generating such files for these services might be tedious, OpenShift Serverless Logic offers REST custom type as a shortcut.</p>
</div>
<div class="paragraph">
<p>When using custom rest, in the function definition, you specify the HTTP URI to be invoked and the HTTP method (get, post, patch, or put) to be used, using the <code>operation</code> string. When the function is invoked, you pass the request arguments as you do when using an OpenAPI function.</p>
</div>
<div class="paragraph">
<p>The following example shows the declaration of a <code>rest</code> function:</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>rest</code> function declaration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "functions": [
    {
      "name": "multiplyAllByAndSum", <i class="conum" data-value="1"></i><b>(1)</b>
      "type": "custom", <i class="conum" data-value="2"></i><b>(2)</b>
      "operation": "rest:post:/numbers/{multiplier}/multiplyByAndSum" <i class="conum" data-value="3"></i><b>(3)</b>
    }
  ]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>multiplyAllAndSum</code> is the function name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>custom</code> is the function type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>rest:post:/numbers/{multiplier}/multiplyByAndSum</code> is the custom operation definition. In the custom operation definition:
<div class="ulist">
<ul>
<li>
<p><code>rest</code> is the reserved operation keyword that indicates this is a REST call.</p>
</li>
<li>
<p><code>post</code> is the HTTP method.</p>
</li>
<li>
<p><code>/numbers/{multiplier}/multiplyByAndSum</code> is the relative endpoint.</p>
</li>
</ul>
</div></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using the relative endpoints you must specify the host as a property. The format of the host property is <code>kogito.sw.functions.&lt;function_name&gt;.host</code>. Therefore, in this example, <code>kogito.sw.functions.multiplyAllByAndSum.host</code> is the host property key. You might override the default port (80) if needed by specifying <code>kogito.sw.functions.multiplyAllAndSum.port</code> property.</p>
</div>
<div class="paragraph">
<p>This particular endpoint expects as body a JSON object whose field <code>numbers</code> is an array of integers, multiplies each item in the array by <code>multiplier</code> and returns the sum of all the multiplied items. Therefore, to invoke it, assuming the input array is stored in the workflow model as property <code>inputNumbers</code>, you should write:</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>rest</code> function call</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "functionRef": {
   "refName": "multiplyAllByAndSum",
   "arguments": {
     "numbers": "$.inputNumbers"
     "multiplier": 3 <i class="conum" data-value="1"></i><b>(1)</b>
   }
 }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>you replace path and query parameters by specifying an argument which name is equal to the path or query parameter. The query or path parameter to be replaced should be enclosed within {} in the endpoint string.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>inputNumbers</code> contains <code>1</code>, <code>2</code>, and <code>3</code>, the output of the call will be  `1*3+2*3+3*3=18.</p>
</div>
<div class="paragraph">
<p>In case you want to specify headers in your HTTP request, you might do it by adding arguments starting with the <code>HEADER_</code> prefix. Therefore, if you add <code>"HEADER_ce_id": "123"</code> to the previous argument set, you will be adding a header named <code>ce_id</code> with the value <code>123</code>  to your request. A similar approach might be used to add query params to a GET request, in that case, you must add arguments starting with the <code>QUERY_</code> prefix. Note that you can also use {} notation for replacements of query parameters included directly in the <code>operation</code> string.</p>
</div>
<div class="paragraph">
<p>For example, given the following function definition that performs a <code>get</code> request</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>get</code> request definition</div>
<div class="content">
<pre>{
  "functions": [
    {
      "name": "getProductList",
      "type": "custom",
      "operation": "rest:get:/products/search?category={category}"
    }
  ]
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can replace <code>{category}</code> specifying an argument with that name, plus adding <code>sort</code> query parameter</p>
</div>
<div class="listingblock">
<div class="title">Example of a <code>get</code> request invocation</div>
<div class="content">
<pre>{
 "functionRef": {
   "refName": "getProductList",
   "arguments": {
     "category": "electronics",
     "QUERY_sort": "asc"
   }
 }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_custom_function_types"><a class="anchor" href="#_additional_custom_function_types"></a>Additional custom function types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can add your custom types by using the Kogito add-on mechanism. As predefined custom types like <a href="#con-func-sysout"><code>sysout</code></a> or <a href="#con-func-java"><code>java</code></a>, the custom type identifier is the prefix of the operation field of the function definition.</p>
</div>
<div class="paragraph">
<p>Kogito add-ons relies on the <a href="https://quarkus.io/guides/writing-extensions">Quarkus extensions</a> mechanism. And the add-on consists of at least two Maven projects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The deployment module, which is responsible for generating the code required for the extension to work.</p>
</li>
<li>
<p>The runtime module, which includes the non-generated classes that are required for the extension to work.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the case of a Serverless Workflow custom type, following are the roles of the modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The deployment project</strong></p>
<div class="paragraph">
<p>The deployment project is expected to configure the work item handler used during runtime to perform the logic associated with the custom type.
It must contain a Java class that inherits from <code>WorkItemTypeHandler</code>. Its responsibilities are to indicate the custom type identifier (the operation prefix, as indicated earlier) and to set up the <code>WorkItemNodeFactory</code> instance passed as a parameter of the <code>fillWorkItemHandler</code> method. That instance is included in the Kogito process definition for that Workflow. As a part of this setup, you must indicate the name of the  <code>WorkItemNodeFactory</code>. You might also provide any relevant metadata for that handler if needed.</p>
</div>
</li>
<li>
<p><strong>The runtime project</strong></p>
<div class="paragraph">
<p>The runtime project consists of a <code>WorkflowWorkItemHandler</code> implementation, which name must match with the one provided to <code>WorkItemNodeFactory</code> during the deployment phase, and a <code>WorkItemHandlerConfig</code> bean that registers that handler with that name.</p>
</div>
<div class="paragraph">
<p>When a Serverless Workflow function is called, Kogito identifies the proper <code>WorkflowWorkItemHandler</code> instance to be used for that function type (using the handler name associated with that type by the deployment project) and then invokes the <code>internalExecute</code> method. The <code>Map</code> parameter contains the function arguments defined in the workflow, and the <code>WorkItem</code> parameter contains the metadata information added to the handler by the deployment project. Hence, the <code>executeWorkItem</code> implementation has access to all the information needed to perform the computational logic intended for that custom type.</p>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_custom_function_type_example"><a class="anchor" href="#_custom_function_type_example"></a>Custom function type example</h3>
<div class="paragraph">
<p>Assuming you want to interact, from a workflow file, with a legacy RPC server as the one defined in <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc-server">this project</a>. This legacy server supports four simple arithmetic operations: add, minus, multiply and divide, which can be invoked using a custom RPC protocol.</p>
</div>
<div class="paragraph">
<p>Since this is an uncommon protocol, the workflow cannot handle them by using any of the predefined Serverless Workflow function types. The available options are to use a Java service, which invokes a Java class that knows how to interact with the server, or define a custom type that knows how to interact with the service.</p>
</div>
<div class="paragraph">
<p>Using the recent approach, you can write a <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-type-example/src/main/resources/customType.sw.json">workflow file</a> defining this function.</p>
</div>
<div class="listingblock">
<div class="title">RPC Custom function definition example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "functions": [
    {
      "name": "division",
      "type": "custom",
      "operation": "rpc:division"
    }
  ],</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>operation</code> starts with <code>rpc</code>, which is the custom type identifier, and continues with <code>division</code>, which denotes the operation that will be executed in the legacy server.</p>
</div>
<div class="paragraph">
<p>A Kogito addon that defines the <code>rpc</code> custom type must be developed for this function definition to be identified. It is consist of a <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc-deployment">deployment project</a> and a <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc">runtime project</a>.</p>
</div>
<div class="paragraph">
<p>The deployment project is responsible for extending the <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc-deployment/src/main/java/org/kie/kogito/examples/sw/services/RPCCustomTypeHandler.java"><code>WorkItemTypeHandler</code></a> and setup of the <code>WorkItemNodeFactory</code> as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example of the RPC function Java implementation</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static org.kie.kogito.examples.sw.custom.RPCCustomWorkItemHandler.NAME;
import static org.kie.kogito.examples.sw.custom.RPCCustomWorkItemHandler.OPERATION;

public class RPCCustomTypeHandler extends WorkItemTypeHandler{


    @Override
    public String type() {
        return "rpc";
    }

    @Override
    protected &lt;T extends RuleFlowNodeContainerFactory&lt;T, ?&gt;&gt; WorkItemNodeFactory&lt;T&gt; fillWorkItemHandler(Workflow workflow,
                                                                                                        ParserContext context,
                                                                                                        WorkItemNodeFactory&lt;T&gt; node,
                                                                                                        FunctionDefinition functionDef) {
        return node.workName(NAME).metaData(OPERATION, trimCustomOperation(functionDef));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example setups the name of the <code>KogitoWorkItemHandler</code>, adds a metadata key with the name of the remote operation (extracted from the Serverless Workflow function definition operation property), and declares that the custom type is named as <code>rpc</code>.</p>
</div>
<div class="paragraph">
<p>The Runtime project contains the <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc/src/main/java/org/kie/kogito/examples/sw/custom/RPCCustomWorkItemHandler.java">KogitoWorkItemHandler</a> and the <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc/src/main/java/org/kie/kogito/examples/sw/custom/RPCCustomWorkItemHandlerConfig.java">WorkItemHandlerConfig</a> implementations.</p>
</div>
<div class="paragraph">
<p>As expected, <code>RPCCustomWorkItemHandler</code> implements the <code>internalExecute</code> method as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example of implementation of the <code>internalExecute</code> method</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> @Override
protected Object internalExecute(KogitoWorkItem workItem, Map&lt;String, Object&gt; parameters)  {
    try {
        Iterator&lt;?&gt; iter = parameters.values().iterator();
        Map&lt;String, Object&gt; metadata = workItem.getNodeInstance().getNode().getMetaData();
        String operationId = (String) metadata.get(OPERATION);
        if (operationId == null) {
            throw new IllegalArgumentException ("Operation is a mandatory parameter");
        }
        return CalculatorClient.invokeOperation((String)metadata.getOrDefault(HOST,"localhost"), (int) metadata.getOrDefault(PORT, 8082),
                OperationId.valueOf(operationId.toUpperCase()), (Integer)iter.next(), (Integer)iter.next());
    } catch (IOException io ) {
        throw new UncheckedIOException(io);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation invokes the <a href="https://github.com/kiegroup/kogito-examples/tree/9.100.x-prod/serverless-workflow-examples/serverless-workflow-custom-type/serverless-workflow-custom-rpc-server/src/main/java/org/kie/kogito/examples/sw/custom/CalculatorClient.java#L45-L67"><code>CalculatorClient.invokeOperation</code></a>, a java static method that knows how to interact with the legacy service. You can obtain the operation parameter from the <code>WorkItem</code> metadata. The dividend and the divisor parameters are obtained from the Map parameter, which contains the function arguments defined in the workflow file.</p>
</div>
<div class="listingblock">
<div class="title">Example of the custom function call from the workflow definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "actions":[
    {
      "functionRef":{
        "refName":"division",
        "arguments":{
          "dividend":".dividend",
          "divisor":".divisor"
        }
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>RPCCustomWorkItemHandlerConfig</code> is a bean that registers the handler name.</p>
</div>
<div class="listingblock">
<div class="title">Example of injecting the custom`WorkItemHandler`</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
RPCCustomWorkItemHandler handler;

@PostConstruct
void init () {
    register(handler.getName(),handler);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a>Additional resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cncf-serverless-workflow-specification-support.html" class="xref page">CNCF Serverless Workflow specification</a></p>
</li>
<li>
<p><a href="understanding-jq-expressions.html" class="xref page">jq expressions in OpenShift Serverless Logic</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_found_an_issue"><a class="anchor" href="#_found_an_issue"></a><em><strong>Found an issue?</strong></em></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you find an issue or any misleading information, please feel free to report it <a href="https://github.com/kiegroup/kogito-docs/issues/new">here</a>.
We really appreciate it!</p>
</div>
</div>
</div>
</article>
        </main>
            </div>
  </div>
</div><footer class="footer">
  <p>Adapted from Antora default UI, (c) 2019</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/tabsBehavior.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
