<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(Community Only) = Building and deploying a OpenShift Serverless Logic application on Kubernetes using the OpenShift Serverless Logic Operator :: Red Hat OpenShift Serverless previews</title>
    <link rel="canonical" href="https://openshift-knative.github.io/docs/docs/latest/serverless-logic/cloud/build-and-deploy-with-serverless-operator-on-kubernetes.html">
    <meta name="description" content="Build and deploy using the OpenShift Serverless Logic Operator a OpenShift Serverless Logic application">
    <meta name="keywords" content="kogito, workflow, serverless, operator, kubernetes, minikube, openshift">
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../_/css/extra.css">
<link rel="stylesheet" href="../../../../_/css/custom.css">
<link rel="stylesheet" href="../../../../_/css/tabs.css">
<link rel="stylesheet" href="../../../../_/font-awesome-4.7.0/css/font-awesome.min.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <button class="navbar-burger" data-target="topbar-nav">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <img src="../../../../_/img/serverless-icon.png" class="navbar-logo" alt="OpenShift Serverless icon">
        <a href="">OpenShift Serverless - Developer Preview Releases</a>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- search broken
        <div class="navbar-item hide-for-print">
          <script async src="https://cse.google.com/cse.js?cx=002898025167115630151:gnr5edrg2eo"></script>
          <div class="gcse-searchbox" enableAutoComplete="true"></div>
        </div>
      -->
        <a class="navbar-item" href="https://openshift-knative.github.io/docs">Home</a>
        <a class="navbar-item" href="https://developers.redhat.com/topics/serverless-architecture">Blog</a>
          <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Upstream Projects</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="https://kogito.kie.org/">Kogito</a>
                  <a class="navbar-item" href="https://knative.dev/docs/functions/">Knative Functions</a>
                  <a class="navbar-item" href="https://knative.dev/docs/eventing/">Knative Eventing</a>
              </div>
          </div>
      </div>
    </div>
  </nav>
<!-- need alt search type-->
<!--<div class="gcse-searchresults"></div>-->
</header>
<div class="main-wrapper">
  <div class="navigation-container" data-component="docs" data-version="main">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Serverless Logic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../about.html">About OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">User Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/create-your-first-workflow-service.html">Creating your first workflow service</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/cncf-serverless-workflow-specification-support.html">CNCF Serverless Workflow specification</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../getting-started/getting-familiar-with-our-tooling.html">Getting familiar with OpenShift Serverless Logic tooling</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Core</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/understanding-jq-expressions.html">jq expressions in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/understanding-workflow-error-handling.html">Error handling in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/working-with-parallelism.html">Parallelism in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/configuration-properties.html">Configuration properties in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/defining-an-input-schema-for-workflows.html">Defining an input schema for your workflows</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/custom-functions-support.html">Custom functions for your OpenShift Serverless Logic service</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../core/timeouts-support.html">Timeouts in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Tooling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-overview.html">Serverless Workflow editor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-vscode-extension.html">VS Code extension for Serverless Workflow editor</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-chrome-extension.html">Chrome GitHub extension for Serverless Workflow editor</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../tooling/quarkus-dev-ui-extension/quarkus-dev-ui-overview.html">Kogito Serverless Workflow Tools extension in Quarkus Dev UI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-instances-page.html">Workflow Instances in Kogito Serverless Workflow Tools extension</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-definition-page.html">Workflow Definitions in Kogito Serverless Workflow Tools extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tooling/kn-plugin-workflow-overview.html">OpenShift Serverless Logic plug-in for Knative CLI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-overview.html">Serverless Logic Web Tools</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-github-integration.html">GitHub integration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-openshift-integration.html">OpenShift integration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-redhat-application-services-integration.html">Red Hat OpenShift Application and Data Services integration</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-deploy-projects.html">Deploying projects</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-enable-kogito-swf-visualization.html">Kogito Serverless Workflow Visualization</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../service-orchestration/orchestration-of-openapi-based-services.html">Orchestrating the OpenAPI services</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../service-orchestration/configuring-openapi-services-endpoints.html">Configuring the OpenAPI services endpoints</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../service-orchestration/orchestration-of-grpc-services.html">Orchestration of gRPC based services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Eventing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/handling-events-on-workflows.html">Event state in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/consume-producing-events-with-kafka.html">Consuming and producing events using Apache Kafka</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/consume-produce-events-with-knative-eventing.html">Consuming and producing events on Knative Eventing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/event-correlation-with-workflows.html">Event correlation in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/working-with-callbacks.html">Callback state in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../eventing/working-with-openapi-callbacks.html">OpenAPI Callback in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../security/authention-support-for-openapi-services.html">Authentication for OpenAPI services in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../security/orchestrating-third-party-services-with-oauth2.html">Orchestration of third-party services using OAuth 2.0 authentication in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Testing and Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/mocking-http-cloudevents-with-wiremock.html">Mocking HTTP CloudEvents sink using WireMock</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/mocking-openapi-services-with-wiremock.html">Mocking OpenAPI services using WireMock</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/basic-integration-tests-with-restassured.html">Testing your workflow application using REST Assured</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../testing-and-troubleshooting/integration-tests-with-postgresql.html">OpenShift Serverless Logic integration test using PostgreSQL</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../persistence/persistence-with-postgresql.html">Running a workflow service using PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../persistence/postgresql-flyway-migration.html">Migrate your PostgreSQL database</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Cloud</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="build-workflow-image-with-quarkus-cli.html">Building workflow images using Quarkus CLI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="deploying-on-minikube.html">Deploying your OpenShift Serverless Logic application on Minikube</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="deploying-on-kubernetes.html">Deploying your OpenShift Serverless Logic application on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="kubernetes-service-discovery.html">Kubernetes service discovery in OpenShift Serverless Logic</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="build-and-deploy-with-serverless-operator-on-kubernetes.html">Buiding and deploying a  OpenShift Serverless Logic application on Kubernetes using the OpenShift Serverless Logic Serverless Operator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/expose-metrics-to-prometheus.html">Exposing the workflow base metrics to Prometheus</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/serverless-dashboard-with-runtime-data.html">Displaying workflow data in dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Use Cases</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/orchestration-based-saga-pattern.html">Saga orchestration example in OpenShift Serverless Logic</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Buildpacks for Serverless Functions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-functions-about.html">About buildpacks for OpenShift Serverless Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-functions-buildpacks.html">Building and deploying functions on the cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-developing-python-functions.html">Developing Python functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../functions/serverless-developing-go-functions.html">Developing Go functions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Documentation</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Documentation</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../../index.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <div class="main-view-and-toolbar">
    <div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../../index.html">Documentation</a></li>
    <li class="crumb">Serverless Logic</li>
    <li class="crumb">User Guides</li>
    <li class="crumb">Cloud</li>
    <li class="crumb"><a href="build-and-deploy-with-serverless-operator-on-kubernetes.html">Buiding and deploying a  OpenShift Serverless Logic application on Kubernetes using the OpenShift Serverless Logic Serverless Operator</a></li>
  </ul>
</nav>
</div>
    <div class="main-view-and-toc">
        <main class="main">
          <article class="doc">
<h1>(Community Only) = Building and deploying a OpenShift Serverless Logic application on Kubernetes using the OpenShift Serverless Logic Operator</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is meant for a quick preview on community repositories, and it&#8217;s not part of the developer preview.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is meant for a quick preview on community repositories, and it&#8217;s not part of the developer preview.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This document describes how to build and deploy your workflow application using a Kubernetes cluster with the <a href="https://github.com/kiegroup/kogito-serverless-operator/">OpenShift Serverless Logic Operator</a>. If you don&#8217;t have any cluster operational, <a href="https://minikube.sigs.k8s.io">Minikube</a> commands are given throughout the guide.</p>
</div>
<div class="paragraph">
<p>Using the OpenShift Serverless Logic Operator, you will be able to build and deploy a OpenShift Serverless Logic application only by having a workflow definition.</p>
</div>
<div class="paragraph">
<p>If you already have a container built and pushed to a container registry and you want to deploy it on the Kubernetes cluster, then you can do it without the operator following the guide <a href="deploying-on-kubernetes.html" class="xref page">Deploying your OpenShift Serverless Logic application on Kubernetes</a>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/kiegroup/kogito-serverless-operator/">OpenShift Serverless Logic Operator</a> is currently in Alpha version, is under active development and is at the moment supporting OpenShift Serverless Logic definitions that are using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Functions</p>
</li>
<li>
<p>States</p>
<div class="ulist">
<ul>
<li>
<p>Switch including dataConditions</p>
</li>
<li>
<p>Inject including data with a transition</p>
</li>
</ul>
</div>
</li>
<li>
<p>Operations including Actions containing functionRef with arguments</p>
</li>
<li>
<p>KeepActive</p>
</li>
<li>
<p>AutoRetries</p>
</li>
<li>
<p>ExpressionsLang (jq or jsonpath)</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A workflow definition.</p>
</li>
<li>
<p>A Kubernetes cluster with admin privileges. If you haven&#8217;t got one prepare, you can use a local <a href="https://minikube.sigs.k8s.io">Minikube</a> instance.</p>
</li>
<li>
<p><code>kubectl</code> command-line tool is installed. Otherwise, Minikube provides it.</p>
</li>
</ul>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_prepare_a_minikube_instance">Prepare a Minikube instance</a></li>
<li><a href="#_setup_openshift_serverless_logic_operator">Setup OpenShift Serverless Logic Operator</a></li>
<li><a href="#_preparing_for_the_build">Preparing for the build</a>
<ul class="sectlevel2">
<li><a href="#_create_a_namespace_for_the_building_phase">Create a namespace for the building phase</a></li>
<li><a href="#_create_a_secret_for_the_container_registry_authentication">Create a secret for the container registry authentication</a></li>
<li><a href="#_create_a_openshift_serverless_logic_platform_containing_the_configuration_i_e_registry_address_secret_for_building_your_workflows">Create a OpenShift Serverless Logic Platform containing the configuration (i.e. registry address, secret) for building your workflows</a></li>
</ul>
</li>
<li><a href="#_build_and_deploy_your_openshift_serverless_logic_application">Build and deploy your OpenShift Serverless Logic application</a></li>
<li><a href="#_check_the_openshift_serverless_logic_application_is_running">Check the OpenShift Serverless Logic application is running</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_prepare_a_minikube_instance"><a class="anchor" href="#_prepare_a_minikube_instance"></a>Prepare a Minikube instance</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">minikube start --cpus 4 --memory 4096 --addons registry --addons metrics-server --insecure-registry "10.0.0.0/24" --insecure-registry "localhost:5000"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To speed up the build time, you can increase CPUs and memory options so that you minikube instance will have more resources. For example, use <code>--cpus 12 --memory 16384</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If it does not work with the default driver, as known as <code>docker</code>, you can try to start with the <code>podman</code> driver as follows:</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Start minikube with podman driver</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">minikube start [...] --driver podman</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are some issues with the <code>crio</code> container runtime and Kaniko that the operator is using. Reference: <a href="https://github.com/GoogleContainerTools/kaniko/issues/2201">ISSUE-2201</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_openshift_serverless_logic_operator"><a class="anchor" href="#_setup_openshift_serverless_logic_operator"></a>Setup OpenShift Serverless Logic Operator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to have an up-and-running instance of the OpenShift Serverless Logic Operator you can use the following command:</p>
</div>
<div class="listingblock">
<div class="title">Install OpenShift Serverless Logic Operator on Kubernetes</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl create -f https://raw.githubusercontent.com/kiegroup/kogito-serverless-operator/v1.32.0/operator.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can follow, then, the deployment of the OpenShift Serverless Logic Operator:</p>
</div>
<div class="listingblock">
<div class="title">Watch the OpenShift Serverless Logic Operator pod</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl get pod -n kogito-serverless-operator-system --watch</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also follow the operatorâ€™s log:</p>
</div>
<div class="listingblock">
<div class="title">Watch the OpenShift Serverless Logic Operator pod logs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl logs deployment/kogito-serverless-operator-controller-manager -n kogito-serverless-operator-system -f</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the operator is running, it will watch for new custom resources (CR) so that you can prepare your environment to be ready to build a new OpenShift Serverless Logic application based on the definitions you will send to the operator.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preparing_for_the_build"><a class="anchor" href="#_preparing_for_the_build"></a>Preparing for the build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should follow these steps to create a container that you can deploy as a service on Kubernetes.</p>
</div>
<div class="sect2">
<h3 id="_create_a_namespace_for_the_building_phase"><a class="anchor" href="#_create_a_namespace_for_the_building_phase"></a>Create a namespace for the building phase</h3>
<div class="paragraph">
<p>Let&#8217;s create a new namespace that will hold all the resources that we (or the operator) will create (pods, deployments, services, secretes, config map, and Custom Resources) in this guide.</p>
</div>
<div class="listingblock">
<div class="title">Create a namespace for the application to build &amp; run in</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create namespace kogito-workflows</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_secret_for_the_container_registry_authentication"><a class="anchor" href="#_create_a_secret_for_the_container_registry_authentication"></a>Create a secret for the container registry authentication</h3>
<div class="listingblock">
<div class="title">Create a secret for the container registry authentication</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create secret docker-registry regcred --docker-server=&lt;registry_url&gt; --docker-username=&lt;registry_username&gt; --docker-password=&lt;registry_password&gt; --docker-email=&lt;registry_email&gt; -n kogito-workflows</code></pre>
</div>
</div>
<div class="paragraph">
<p>or you can directly import your local docker config into your Kubernetes cluster:</p>
</div>
<div class="listingblock">
<div class="title">Create a secret for the container registry authentication based on local docker config</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create secret generic regcred --from-file=.dockerconfigjson=${HOME}/.docker/config.json --type=kubernetes.io/dockerconfigjson -n kogito-workflows</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_openshift_serverless_logic_platform_containing_the_configuration_i_e_registry_address_secret_for_building_your_workflows"><a class="anchor" href="#_create_a_openshift_serverless_logic_platform_containing_the_configuration_i_e_registry_address_secret_for_building_your_workflows"></a>Create a OpenShift Serverless Logic Platform containing the configuration (i.e. registry address, secret) for building your workflows</h3>
<div class="paragraph">
<p>The OpenShift Serverless Logic Platform CR is the resource used to control the behavior of the OpenShift Serverless Logic Operator.
It defines the behavior of all Custom Resources (Workflow and Build) in the given namespace.</p>
</div>
<div class="paragraph">
<p>Since the OpenShift Serverless Logic Operator is installed in global mode, you will need to specify a OpenShift Serverless Logic Platform CR in each namespace where you want the operator to be executed.
You can find a basic OpenShift Serverless Logic Serverless Platform CR example in the <code>config/samples</code> folder that you can simply apply to configure your operator.</p>
</div>
<div class="listingblock">
<div class="title">Create a OpenShift Serverless Logic Platform CR</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f https://raw.githubusercontent.com/kiegroup/kogito-serverless-operator/v1.32.0/config/samples/sw.kogito_v1alpha08_kogitoserverlessplatform.yaml -n kogito-workflows</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: In this Custom Resource, spec.platform.registry.secret is the name of the secret you created just before.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also update "on-the-fly" the OpenShift Serverless Logic Platform CR registry field with this command (change &lt;YOUR_REGISTRY&gt;)</p>
</div>
<div class="listingblock">
<div class="title">Create a OpenShift Serverless Logic Platform CR with a specific registry</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl https://raw.githubusercontent.com/kiegroup/kogito-serverless-operator/v1.32.0/config/samples/sw.kogito_v1alpha08_kogitoserverlessplatform.yaml | sed "s|address: .*|address: &lt;YOUR_REGISTRY&gt;" | kubectl apply -f -</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to retrieve the Cluster IP address of Minikube&#8217;s internal registry to configure your platform, you can use the following command:</p>
</div>
<div class="listingblock">
<div class="title">Retrieve Minikube registry internal IP</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get svc registry -n kube-system -ojsonpath='{.spec.clusterIP}'</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build_and_deploy_your_openshift_serverless_logic_application"><a class="anchor" href="#_build_and_deploy_your_openshift_serverless_logic_application"></a>Build and deploy your OpenShift Serverless Logic application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can now send your OpenShift Serverless Logic Custom Resource to the operator which includes the OpenShift Serverless Logic definition.</p>
</div>
<div class="paragraph">
<p>You can find a basic OpenShift Serverless Logic Platform CR example in the <code>config/samples</code> folder that you can simply apply to configure your operator.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f https://raw.githubusercontent.com/kiegroup/kogito-serverless-operator/v1.32.0/config/samples/sw.kogito_v1alpha08_kogitoserverlessworkflow.yaml -n kogito-workflows</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can check the logs of the build of your workflow via:</p>
</div>
<div class="listingblock">
<div class="title">Get the OpenShift Serverless Logic application pod logs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl logs kogito-greeting-builder -n kogito-workflows</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final pushed image must be printed into the logs at the end of the build.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_check_the_openshift_serverless_logic_application_is_running"><a class="anchor" href="#_check_the_openshift_serverless_logic_application_is_running"></a>Check the OpenShift Serverless Logic application is running</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to check that the OpenShift Serverless Logic Greeting application is up and running, you can try to perform a test HTTP call, from the greeting pod.</p>
</div>
<div class="listingblock">
<div class="title">Check the greeting application is running</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl patch svc greeting -n kogito-workflows -p '{"spec": {"type": "NodePort"}}'
GREETING_SVC=$(minikube service greeting -n kogito-workflows --url)
curl -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' -d '{"name": "John", "language": "English"}' $GREETING_SVC/greeting</code></pre>
</div>
</div>
<div class="paragraph">
<p>If everything is working well you should receive a response like this:</p>
</div>
<div class="listingblock">
<div class="title">Response from the greeting application</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"id":"b5fbfaa3-b125-4e6c-9311-fe5a3577efdd","workflowdata":{"name":"John","language":"English","greeting":"Hello from JSON Workflow, "}}</code></pre>
</div>
</div>
</div>
</div>
</article>
        </main>
            </div>
  </div>
</div><footer class="footer">
  <p>Adapted from Antora default UI, (c) 2019</p>
</footer>
<script src="../../../../_/js/site.js"></script>
<script src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/tabsBehavior.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
